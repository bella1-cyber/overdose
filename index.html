<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>S.R.H.Q - TACTICAL COMMAND CENTER</title>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&family=Rajdhani:wght@500;600;700&family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
    :root {
        --bg-color: #020202;
        --primary: #d946ef;
        --primary-dim: rgba(217, 70, 239, 0.15);
        --alert: #ff2a4d;
        --safe: #00ff9d;
        --text: #e0e0e0;
        --panel: rgba(10, 10, 12, 0.85);
        --border-color: rgba(217, 70, 239, 0.4);
        --grid-line: rgba(255, 255, 255, 0.03);
    }

    * { box-sizing: border-box; }
    
    body {
        margin: 0; padding: 0;
        background: var(--bg-color);
        color: var(--text);
        font-family: 'Rajdhani', 'Noto Sans KR', sans-serif;
        min-height: 100vh; 
        overflow-y: auto; 
        overflow-x: hidden;
        display: flex; flex-direction: column;
        user-select: none; -webkit-user-select: none;
    }

    body.modal-open {
        overflow: hidden;
    }

    #bg-layer {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
        background: 
            linear-gradient(90deg, var(--grid-line) 1px, transparent 1px),
            linear-gradient(var(--grid-line) 1px, transparent 1px),
            radial-gradient(circle at 50% 50%, rgba(20, 20, 30, 0), #000 90%);
        background-size: 40px 40px, 40px 40px, 100% 100%;
        opacity: 0.5;
    }
    #map-overlay {
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 80vw; height: 80vh; border: 1px solid rgba(255,255,255,0.05); border-radius: 50%;
        z-index: -1; opacity: 0.2; pointer-events: none;
        background: repeating-radial-gradient(rgba(217, 70, 239, 0.1) 0, transparent 1px, transparent 50px);
        animation: mapRotate 60s linear infinite;
    }
    @keyframes mapRotate { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }

    body::after {
        content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0;
        background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                    linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
        background-size: 100% 2px, 3px 100%;
        pointer-events: none; z-index: 9999;
    }

    .hidden { display: none !important; }
    .fade-in { animation: fadeIn 0.8s forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .top-ticker {
        width: 100%; height: 50px;
        background: #000; border-bottom: 2px solid #333;
        display: flex; align-items: center; overflow: hidden; position: relative; z-index: 100;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        flex-shrink: 0;
    }
    .top-ticker::before {
        content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(rgba(255,255,255,0.1) 15%, transparent 20%);
        background-size: 4px 4px; pointer-events: none; z-index: 5;
    }

    .ticker-label {
        background: var(--alert); color: #000; font-weight: 800; padding: 0 20px; height: 100%;
        display: flex; align-items: center; justify-content: center;
        font-size: 1.1rem; z-index: 6; min-width: 140px; letter-spacing: 1px;
        box-shadow: 5px 0 10px rgba(0,0,0,0.5);
    }
    .ticker-wrapper {
        flex: 1; overflow: hidden; position: relative; height: 100%; display: flex; align-items: center;
        background: rgba(20, 0, 0, 0.3);
    }
    .ticker-content {
        white-space: nowrap; animation: ticker 45s linear infinite; 
        font-size: 1.2rem; font-family: 'Noto Sans KR', sans-serif; font-weight: bold;
        padding-left: 20px; display: flex; align-items: center;
    }
    
    .news-item { margin-right: 60px; display: inline-flex; align-items: center; }
    .news-tag { padding: 2px 8px; border-radius: 4px; margin-right: 10px; font-size: 0.8rem; color: #000; font-weight: bold; }
    
    .tag-world { background: #3b82f6; color: #fff; } 
    .tag-notice { background: var(--safe); color: #000; } 
    .tag-warn { background: #ff9800; color: #000; } 
    .tag-danger { background: var(--alert); color: #fff; animation: blink 1s infinite; } 
    .tag-sys { background: var(--primary); color: #fff; } 
    .text-highlight { color: #fff; text-shadow: 0 0 5px rgba(255,255,255,0.5); }
    
    @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-150%); } }
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

    .control-bar {
        width: 100%; 
        background: rgba(10, 10, 15, 0.95);
        border-bottom: 1px solid #333; 
        display: flex; align-items: center; justify-content: space-between;
        padding: 10px 20px; z-index: 90;
        flex-shrink: 0;
        flex-wrap: wrap;
        gap: 10px;
    }
    .system-status { font-size: 0.9rem; color: #666; display: flex; gap: 15px; white-space: nowrap; }
    .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--safe); display: inline-block; margin-right: 5px; box-shadow: 0 0 5px var(--safe); }
    
    .bgm-controls { display: flex; gap: 5px; align-items: center; flex-wrap: wrap; }
    .bgm-label { font-size: 0.8rem; color: var(--primary); margin-right: 10px; font-weight: bold; white-space: nowrap; }
    .bgm-btn-mini { 
        background: #111; border: 1px solid #444; color: #888; padding: 4px 12px; cursor: pointer; 
        font-family: 'Rajdhani'; font-size: 0.8rem; transition: 0.2s; white-space: nowrap;
    }
    .bgm-btn-mini:hover, .bgm-btn-mini.active { border-color: var(--primary); color: var(--primary); background: rgba(217, 70, 239, 0.1); }

    #main-dashboard {
        display: flex; width: 100%; 
        min-height: calc(100vh - 100px);
        max-width: 1600px; margin: 0 auto;
        padding: 20px; gap: 20px; position: relative;
    }
    
    .ops-panel {
        width: 350px; display: flex; flex-direction: column; gap: 15px; flex-shrink: 0;
    }
    .panel-box {
        background: rgba(0,0,0,0.7); border: 1px solid #333; padding: 15px;
        position: relative; backdrop-filter: blur(5px);
    }
    .panel-title {
        color: var(--primary); font-size: 0.9rem; border-bottom: 1px solid var(--primary-dim);
        padding-bottom: 5px; margin-bottom: 10px; display: flex; justify-content: space-between;
    }
    
    .loc-list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 8px; }
    .loc-item {
        display: flex; align-items: center; gap: 10px; font-size: 0.85rem; color: #ccc;
        padding: 8px; border: 1px solid transparent; transition: 0.3s; cursor: pointer;
    }
    .loc-item:hover { border-color: var(--primary); background: var(--primary-dim); }
    .loc-icon { width: 24px; text-align: center; }
    .loc-status { margin-left: auto; font-size: 0.7rem; padding: 2px 6px; border-radius: 2px; }
    .st-safe { background: rgba(0,255,157,0.2); color: var(--safe); }
    .st-danger { background: rgba(255,42,77,0.2); color: var(--alert); }
    .st-warn { background: rgba(255, 200, 0, 0.2); color: #ffca28; }

    .log-window {
        height: 200px; overflow: hidden; font-family: monospace; font-size: 0.75rem; color: #666;
        display: flex; flex-direction: column; justify-content: flex-end;
        border-top: 1px solid #333; background: #050505; padding: 10px;
    }
    .log-line { margin-bottom: 4px; border-left: 2px solid transparent; padding-left: 5px; }
    .log-line.new { border-left-color: var(--primary); color: #aaa; animation: flash 0.5s; }
    @keyframes flash { 0% { background: var(--primary); color: #000; } 100% { background: transparent; } }

    .squad-section {
        flex: 1; display: flex; flex-direction: column;
    }
    .grid-header {
        display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px;
    }
    .grid-title { font-size: 1.5rem; color: #fff; letter-spacing: 2px; }
    .grid-sub { color: var(--alert); font-size: 0.9rem; animation: blink 2s infinite; }

    .char-grid {
        display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; 
    }
    .char-card {
        background: #000; border: 1px solid #333; cursor: pointer; position: relative; overflow: hidden;
        transition: 0.3s; display: flex; flex-direction: column;
        height: 340px; /* â˜…â˜…â˜… ìˆ˜ì •ë¨ â˜…â˜…â˜… */
    }
    .char-card:hover { border-color: var(--primary); box-shadow: 0 0 20px var(--primary-dim); transform: scale(1.02); z-index: 10; }
    
    .card-img-wrap { width: 100%; height: 75%; position: relative; overflow: hidden; }
    .card-img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(100%); transition: 0.5s; }
    .char-card:hover .card-img { filter: grayscale(0%); transform: scale(1.1); }
    
    .vital-line {
        position: absolute; bottom: 0; left: 0; width: 100%; height: 20px;
        background: rgba(0,0,0,0.8); display: flex; align-items: center; padding: 0 5px; gap: 5px;
    }
    .ecg { width: 100%; height: 100%; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><path d="M0 10 H20 L25 5 L30 15 L35 10 H100" stroke="%2300ff9d" fill="none" stroke-width="1"/></svg>'); animation: ecgMove 2s linear infinite; }
    @keyframes ecgMove { from { background-position: 0 0; } to { background-position: -100px 0; } }

    .card-info { padding: 10px; flex: 1; background: linear-gradient(to bottom, #111, #050505); border-top: 1px solid #222; }
    .card-name { font-size: 1.1rem; color: #fff; font-weight: bold; }
    .card-role { font-size: 0.75rem; color: var(--primary); }
    .status-badge { 
        position: absolute; top: 10px; right: 10px; font-size: 0.6rem; padding: 2px 6px; 
        background: #000; border: 1px solid var(--safe); color: var(--safe); text-transform: uppercase;
    }
    .char-card:hover .status-badge { background: var(--safe); color: #000; }

    .user-card-slot { border-color: var(--primary); background: rgba(217, 70, 239, 0.05); }
    .user-card-slot .card-img { filter: none; }
    .user-card-slot .card-name { color: var(--primary); }
    
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 9000; display: flex; justify-content: center; align-items: center; overflow-y: auto; padding: 20px; }
    .modal-box { width: 95%; max-width: 1100px; height: auto; max-height: 90vh; background: #080a0c; border: 1px solid var(--primary); display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(217, 70, 239, 0.15); margin: auto; }
    .modal-header { padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; background: rgba(217, 70, 239, 0.05); flex-shrink: 0; }
    .modal-body { display: flex; flex: 1; overflow-y: auto; min-height: 0; }

    .view-left { width: 40%; padding: 20px; border-right: 1px solid #333; display: flex; flex-direction: column; gap: 15px; }
    .main-img-view { width: 100%; height: 400px; object-fit: cover; border: 1px solid #444; margin-bottom: 10px; flex-shrink: 0; }
    .gallery-slots { display: flex; gap: 5px; height: 70px; width: 100%; margin-top: 10px; flex-shrink: 0; }
    .slot-img { flex: 1; height: 100%; background: #111; border: 1px solid #333; cursor: pointer; overflow: hidden; opacity: 0.6; transition: 0.2s; }
    .slot-img:hover, .slot-img.active { border-color: var(--primary); opacity: 1; }
    .slot-img img { width: 100%; height: 100%; object-fit: cover; }
    .view-right { width: 60%; padding: 30px; overflow-y: auto; }
    .info-block { margin-bottom: 25px; }
    .info-label { color: var(--primary); font-size: 0.9rem; margin-bottom: 8px; font-weight: bold; letter-spacing: 1px; }
    .info-content { color: #ccc; line-height: 1.6; font-size: 1rem; white-space: pre-line; }
    
    .voice-slots { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; margin-top: 10px; }
    .voice-btn { 
        padding: 10px; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; gap: 8px; 
        background: #111; border: 1px solid #333; color: #888; cursor: pointer; transition: 0.2s;
        text-align: center;
    }
    .voice-btn:hover { border-color: var(--primary); color: var(--primary); }
    .voice-btn.playing { border-color: var(--alert); color: var(--alert); background: rgba(255, 42, 77, 0.1); }
    .voice-btn[disabled] { cursor: not-allowed; color: #444; border-color: #222; }
    .voice-btn[disabled]:hover { color: #444; border-color: #222; }

    /* â˜…â˜…â˜… ì¶”ê°€ëœ ë¶€ë¶„: ìŠ¤í¬ì¼ëŸ¬ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ â˜…â˜…â˜… */
    .spoiler-box {
        background: rgba(10, 0, 0, 0.6);
        border: 1px dashed var(--alert);
        padding: 20px;
        cursor: pointer;
        position: relative;
        transition: 0.3s;
        min-height: 120px;
        display: flex; align-items: center; justify-content: center;
        text-align: center;
        overflow: hidden;
    }
    .spoiler-box:hover {
        background: rgba(255, 42, 77, 0.1);
        box-shadow: 0 0 15px rgba(255, 42, 77, 0.2);
    }
    .spoiler-box.revealed {
        border-style: solid;
        border-color: #333;
        background: rgba(0,0,0,0.3);
        cursor: default;
        display: block; text-align: left;
        box-shadow: none;
    }
    .spoiler-text {
        display: none;
        font-size: 0.95rem; line-height: 1.7; color: #ccc; white-space: pre-line;
        font-family: 'Noto Sans KR';
    }
    .spoiler-warning {
        color: var(--alert); font-weight: 800; letter-spacing: 2px;
        animation: blink 1s infinite;
        font-size: 1rem;
        text-shadow: 0 0 5px var(--alert);
        pointer-events: none;
    }
    .spoiler-box.revealed .spoiler-text { display: block; animation: fadeIn 0.5s; }
    .spoiler-box.revealed .spoiler-warning { display: none; }
    
    /* â˜…â˜…â˜… ì¶”ê°€ëœ ë¶€ë¶„: ìŠ¤í† ë¦¬ ë‚´ ëŒ€ì‚¬ ìŠ¤íƒ€ì¼ â˜…â˜…â˜… */
    .story-quote {
        font-family: 'Gowun Batang', serif;
        color: var(--alert);
        font-size: 1.1rem;
        margin-bottom: 15px;
        text-shadow: 0 0 5px rgba(255, 42, 77, 0.5);
        line-height: 1.6;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 42, 77, 0.2);
    }

    #start-screen, #story-screen, #bridge-screen, #intro-screen, #scan-screen {
        position: fixed; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center;
        background: var(--bg-color); z-index: 3000;
        overflow-y: auto;
    }
    #story-screen { background: black; z-index: 5000; }
    #bridge-screen { background: #000; z-index: 4500; }
    #intro-screen { z-index: 4000; }
    #start-screen { z-index: 10000; background: #020202; }
    
    button {
        background: linear-gradient(90deg, rgba(217, 70, 239, 0.1), transparent);
        border: 1px solid var(--primary); color: var(--primary);
        padding: 12px 30px; font-family: 'Rajdhani', sans-serif; font-weight: 700; font-size: 1rem;
        cursor: pointer; transition: 0.3s; text-transform: uppercase; letter-spacing: 2px;
        clip-path: polygon(15px 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%, 0 15px);
    }
    button:hover { background: var(--primary); color: #fff; box-shadow: 0 0 25px var(--primary-dim); }
    input {
        background: rgba(0,0,0,0.6); border: 1px solid #444; color: var(--primary);
        padding: 15px; font-size: 1.2rem; text-align: center; width: 100%; outline: none;
        font-family: 'Rajdhani', sans-serif; transition: 0.3s; margin-bottom: 10px;
    }
    .avatar-selection { display: flex; gap: 20px; justify-content: center; margin-bottom: 20px; }
    .avatar-opt { width: 120px; height: 120px; border: 2px solid #333; background: #000; cursor: pointer; opacity: 0.5; transition: 0.3s; position: relative; }
    .avatar-opt img { width: 100%; height: 100%; object-fit: cover; }
    .avatar-opt.active { border-color: var(--primary); opacity: 1; box-shadow: 0 0 20px var(--primary-dim); transform: scale(1.05); }
    .avatar-label { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.8); color: white; font-size: 0.8rem; text-align: center; padding: 2px 0; }
    
    .hand-container {
        width: 60vw; height: 60vw; max-width: 400px; max-height: 400px;
        border: 1px solid rgba(217, 70, 239, 0.2); border-radius: 50%;
        position: relative; display: flex; justify-content: center; align-items: center;
        margin: 30px 0; cursor: pointer; 
        background: radial-gradient(circle, rgba(217, 70, 239, 0.05), transparent 70%);
        -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; touch-action: none;
    }
    .hand-img { width: 60%; opacity: 0.3; filter: invert(1); transition: 0.3s; pointer-events: none; }
    .scanning .hand-img { opacity: 1; filter: invert(1) sepia(1) saturate(5) hue-rotate(240deg) drop-shadow(0 0 20px var(--primary)); }
    .radar-sweep {
        position: absolute; width: 100%; height: 100%; border-radius: 50%;
        background: conic-gradient(from 0deg, transparent 0%, rgba(217, 70, 239, 0.5) 20%, transparent 40%);
        animation: radar 1.5s infinite linear; display: none;
    }
    @keyframes radar { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    .user-profile-box {
        max-width: 600px; height: auto; padding: 30px; text-align: center; position: relative;
    }
    .user-data-row {
        background: rgba(255,255,255,0.05); padding: 15px; margin: 10px 0; border-left: 3px solid var(--primary); text-align: left;
    }
    .data-label { color: #888; font-size: 0.8rem; display: block; margin-bottom: 5px; }
    .data-val { color: #fff; font-size: 1.1rem; font-weight: bold; }
    .action-btn-group { display: flex; gap: 10px; margin-top: 20px; justify-content: center; }
    .btn-alert { border-color: var(--alert); color: var(--alert); }
    .btn-alert:hover { background: var(--alert); color: #000; box-shadow: 0 0 20px var(--alert); }

    .emergency-state { animation: redAlert 1s infinite; }
    .emergency-state::before {
        content: "EMERGENCY"; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg);
        font-size: 10vw; color: rgba(255,0,0,0.1); font-weight: 900; z-index: 1; pointer-events: none;
    }
    @keyframes redAlert { 
        0%, 100% { box-shadow: inset 0 0 0 0 transparent; } 
        50% { box-shadow: inset 0 0 100px rgba(255,0,0,0.5); } 
    }

    .mission-modal-box { max-width: 800px; height: auto; border-color: var(--alert); background: #0a0000; }
    .mission-char-img { width: 150px; height: 150px; border-radius: 50%; border: 3px solid var(--alert); object-fit: cover; margin: 0 auto 20px; }
    .mission-dialogue { font-family: 'Gowun Batang'; font-size: 1.5rem; color: #fff; margin: 20px 0; line-height: 1.6; }

    #image-popup {
        display: flex; justify-content: center; align-items: center;
    }
    #image-popup img {
        max-width: 90%; max-height: 90%; object-fit: contain; border: 2px solid var(--primary);
    }
    #image-popup .close-btn, #voice-popup .close-btn, #location-modal .modal-box button {
        position: absolute; top: 20px; right: 20px; padding: 10px 20px; z-index: 10;
    }
    #location-modal .modal-box button {
        position: static; margin-top: 20px;
    }

    #voice-popup .modal-box {
        max-width: 600px; padding: 40px; text-align: center; border-color: var(--alert);
    }
    #voice-popup-text {
        font-family: 'Gowun Batang'; font-size: 1.5rem; color: #fff; margin: 20px 0; line-height: 1.6;
    }
    #voice-popup-waveform {
        display: flex; justify-content: center; align-items: center; height: 50px; gap: 4px;
        margin: 30px 0;
    }

    @media (max-width: 1024px) {
        #main-dashboard { flex-direction: column; height: auto; overflow: visible; padding-bottom: 50px; }
        .ops-panel { width: 100%; }
        .char-grid { grid-template-columns: repeat(2, 1fr); height: auto; }
        .char-card { height: 250px; }
        .top-ticker { height: 40px; }
        .ticker-label { font-size: 0.8rem; padding: 0 10px; min-width: auto; }
        .ticker-content { font-size: 0.9rem; }
        .news-item { margin-right: 30px; }
        .control-bar { padding: 10px; flex-direction: column; align-items: flex-start; height: auto; }
        .system-status { display: none; }
        .bgm-controls { width: 100%; overflow-x: auto; padding-bottom: 5px; justify-content: flex-start; }
        
        .modal-body { flex-direction: column; }
        .view-left, .view-right { width: 100%; border: none; height: auto; overflow-y: visible; }
    }
    
    @media (max-width: 480px) {
        .user-profile-box .action-btn-group {
            flex-direction: column;
        }
    }

    .story-img-container {
        position: relative; overflow: hidden;
        width:100%; height:60vh; border:1px solid #333; margin-bottom:20px;
        background-color: #000;
    }
    .story-img-container > img {
        width: 100%; height: 100%; object-fit: cover;
        animation: main-img-shake 4s infinite linear;
    }
    .story-img-container::after {
        content: ''; position: absolute; top: 0; left: 0;
        width: 100%; height: 100%;
        background: repeating-linear-gradient(0deg, rgba(0,0,0,0) 0.5px, rgba(255,255,255,0.1) 1px, rgba(0,0,0,0.2) 2px);
        opacity: 0;
        animation: glitch-noise 2s infinite steps(1);
    }
    .story-img-container::before {
        content: ''; position: absolute; top: 0; left: 0;
        width: 100%; height: 100%;
        background-image: var(--glitch-image);
        background-size: cover; background-position: center;
        animation: glitch-slice 2s infinite steps(1);
    }
    @keyframes main-img-shake {
        0%, 100% { transform: translate(0, 0); } 25% { transform: translate(0.5px, -0.5px); } 50% { transform: translate(-0.5px, 0.5px); } 75% { transform: translate(0.5px, 0.5px); }
    }
    @keyframes glitch-noise {
        0% { opacity: 0; } 95% { opacity: 0.5; top: -5px; } 96% { opacity: 0.2; top: 5px; } 97% { opacity: 0.8; top: -2px; } 98% { opacity: 0.3; top: 2px; } 99% { opacity: 0.6; top: 0; } 100% { opacity: 0; }
    }
    @keyframes glitch-slice {
        0% { clip-path: inset(0); transform: translate(0, 0); opacity: 0; } 97% { clip-path: inset(50% 0 20% 0); transform: translate(-5px, 2px); opacity: 1; } 98% { clip-path: inset(10% 0 60% 0); transform: translate(5px, -2px); opacity: 1; } 99% { clip-path: inset(30% 0 40% 0); transform: translate(2px, 1px); opacity: 1; } 100% { clip-path: inset(0); transform: translate(0, 0); opacity: 0; }
    }

    #voice-waveform {
        display: flex; align-items: center; height: 12px; gap: 2px;
    }
    .wave-bar {
        width: 3px; height: 100%; background: var(--primary);
        animation: waveAnimate 1.2s infinite ease-in-out;
    }
    .wave-bar:nth-child(2) { animation-delay: -1.0s; } .wave-bar:nth-child(3) { animation-delay: -0.8s; } .wave-bar:nth-child(4) { animation-delay: -0.6s; } .wave-bar:nth-child(5) { animation-delay: -0.4s; }
    @keyframes waveAnimate { 0%, 40%, 100% { transform: scaleY(0.2); } 20% { transform: scaleY(1.0); } }
    </style>
</head>
<body>

    <div id="bg-layer"></div>
    <div id="map-overlay"></div>

    <audio id="bgm-player" loop></audio>
    <audio id="sfx-hover" src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/sfx_hover.mp3"></audio>
    <audio id="sfx-click" src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/sfx_click.mp3"></audio>
    <audio id="sfx-type" src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/sfx_type.mp3"></audio>
    <audio id="sfx-scan" src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/sfx_scan.mp3"></audio>
    <audio id="sfx-access" src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/sfx_access.mp3"></audio>
    <audio id="sfx-alarm" src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/sfx_alarm.mp3" loop></audio>
    
    <audio id="narr-player"></audio>
    <audio id="voice-player"></audio>

    <div class="top-ticker">
        <div class="ticker-label">BREAKING NEWS</div>
        <div class="ticker-wrapper">
            <div class="ticker-content">
                <span class="news-item"><span class="news-tag tag-world">WORLD</span><span class="text-highlight">2026ë…„ ë„ì¿„ ì‹ ì£¼ì¿  ëŒ€ì¬í•´ 10ì£¼ê¸° ì¶”ëª¨ì‹ ì˜ˆì •</span></span>
                <span class="news-item"><span class="news-tag tag-notice">NOTICE</span><span class="text-highlight">ì „ ì„¼í‹°ë„¬/ê°€ì´ë“œ ì •ê¸° ë“±ë¡ ê¸°ê°„ (ë§ˆê° ì„ë°•)</span></span>
                <span class="news-item"><span class="news-tag tag-danger">WARNING</span><span class="text-highlight">ì‹œë¶€ì•¼ 13êµ¬ì—­ ì´í˜•ì²´ ë°˜ì‘ ê¸‰ì¦, ì ‘ê·¼ ê¸ˆì§€ êµ¬ì—­ ì„¤ì •</span></span>
                <span class="news-item"><span class="news-tag tag-warn">BLACK LABEL</span><span class="text-highlight">ì œ0ê¸°ë™ë¶€ëŒ€ ì‘ì „ êµ¬ì—­ ë‚´ ë¯¼ê°„ì¸ ì¦‰ì‹œ ëŒ€í”¼ë ¹ ë°œë ¹</span></span>
                <span class="news-item"><span class="news-tag tag-sys">SYSTEM</span><span class="text-highlight">íŠ¹ëŒ€ë³¸ ë©”ì¸ ì„œë²„ ë³´ì•ˆ íŒ¨ì¹˜ ì™„ë£Œ (Ver 4.0.2)</span></span>
            </div>
        </div>
    </div>

    <div class="control-bar hidden" id="control-bar">
        <div class="system-status">
            <span><span class="status-dot"></span>SERVER: ONLINE</span>
            <span><span class="status-dot"></span>DEFCON: 4</span>
        </div>
        <div class="bgm-controls" id="bgm-controls">
            <span class="bgm-label">â™¬ AUDIO CONTROL</span>
        </div>
    </div>

    <div id="start-screen">
        <div style="text-align:center;">
            <div style="font-size:5rem; font-weight:800; color:var(--primary); letter-spacing:10px; text-shadow:2px 2px 0 var(--alert);">S.R.H.Q</div>
            <p style="color:#666; letter-spacing:3px;">SPECIAL RESPONSE HEADQUARTERS</p>
            <div style="width:300px; height:4px; background:#111; margin:30px auto; position:relative;">
                <div id="boot-bar" style="height:100%; background:var(--primary); width:0%; transition:width 0.1s;"></div>
            </div>
            <div id="start-btn-group" class="hidden fade-in">
                <button id="btn-init">SYSTEM CONNECT</button>
                <p id="earphone-notice" style="color:#888; font-size:0.8rem; margin-top:20px; font-family: 'Noto Sans KR', sans-serif;">ìŒì„±ê³¼ BGMì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì–´í°/í—¤ë“œí° ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
            </div>
            <p id="boot-text" style="color:#444; font-family:monospace; font-size:0.8rem; margin-top:10px;">INITIALIZING...</p>
        </div>
    </div>

    <div id="story-screen" class="hidden">
        <div style="position:relative; max-width:1000px; width:100%; padding:20px;">
            <div class="story-img-container">
                <img id="story-img" src="">
            </div>
            <div id="story-text" style="font-family:'Gowun Batang'; font-size:1.4rem; color:#eee; background:rgba(0,0,0,0.6); padding:30px; text-align:center; min-height:120px; border-top:1px solid rgba(217,70,239,0.3); border-bottom:1px solid rgba(217,70,239,0.3);"></div>
        </div>
        <button id="skip-btn" style="position:absolute; bottom:30px; right:30px; font-size:0.8rem; padding:10px 20px;">SKIP >></button>
    </div>

    <div id="bridge-screen" class="hidden">
        <div style="font-size:2rem; color:var(--primary); letter-spacing:5px; animation:blink 0.5s infinite;">CONNECTING...</div>
    </div>

    <div id="intro-screen" class="hidden">
        <div style="width:90%; max-width:800px; padding:40px; background:rgba(18,12,22,0.9); border:1px solid var(--border-color); position:relative; margin-bottom:40px;">
            <div style="position:absolute; top:-14px; left:20px; background:#050505; color:var(--primary); border:1px solid var(--primary); padding:0 10px; font-size:0.8rem; display:flex; align-items:center; gap:8px;">
                <span>COMMUNICATION CHANNEL: OPEN</span>
                <div id="voice-waveform" class="hidden">
                    <div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div>
                </div>
            </div>
            <div id="msg-content" style="font-family:'Gowun Batang'; font-size:1.3rem; line-height:1.8;"></div>
        </div>
        <div id="input-area" class="hidden fade-in" style="width:100%; max-width:500px;">
            <div class="avatar-selection">
                <div class="avatar-opt" onclick="selectAvatar('ë‚¨ì„±', 'https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769351421144_01.jpeg', this)">
                    <img src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769351421144_01.jpeg">
                    <div class="avatar-label">MALE</div>
                </div>
                <div class="avatar-opt" onclick="selectAvatar('ì—¬ì„±', 'https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769351557630_01.jpeg', this)">
                    <img src="https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769351557630_01.jpeg">
                    <div class="avatar-label">FEMALE</div>
                </div>
            </div>
            <input type="text" id="user-name" placeholder="CODE NAME" autocomplete="off">
            <input type="number" id="user-age" placeholder="AGE" autocomplete="off">
            <div style="display:flex; gap:10px;">
                <button style="flex:1" onclick="submitForm('SENTINEL')">SENTINEL</button>
                <button style="flex:1" onclick="submitForm('GUIDE')">GUIDE</button>
            </div>
        </div>
    </div>

    <div id="scan-screen" class="hidden">
        <h2 style="color:var(--primary); letter-spacing:5px;">BIOMETRIC SCAN</h2>
        <div class="hand-container" id="hand-scanner">
            <div class="radar-sweep" id="radar"></div>
            <img src="https://pub-7c1beb3ad40844ff87d9eb2fad52b153.r2.dev/hand.png" class="hand-img">
        </div>
        <p id="scan-status" style="color:#666; font-family:monospace;">HOLD TO SCAN</p>
    </div>
    
    <div id="result-modal" class="modal-overlay hidden">
        <div class="modal-box" style="height:auto; max-width:500px; padding:40px; text-align:center;">
            <h3 style="color:var(--primary);">ANALYSIS COMPLETE</h3>
            <div id="result-rank" style="font-size:6rem; font-weight:800; color:var(--alert); margin:20px 0;">?</div>
            <p id="result-ability" style="font-size:1.2rem; font-weight:bold; color:white;"></p>
            <button onclick="enterDashboard()" style="margin-top:30px;">ACCESS DATABASE</button>
        </div>
    </div>

    <div id="main-dashboard" class="hidden">
        
        <div class="ops-panel">
            <div class="panel-box">
                <div class="panel-title">
                    <span>ARCHIVED FOOTAGE</span>
                    <span style="font-size:0.7rem;">CLASSIFIED</span>
                </div>
                <div id="youtube-embed-container" style="aspect-ratio: 16 / 9; width: 100%; background: #000;">
                    <iframe width="100%" height="100%" src="https://www.youtube.com/embed/3d2yctBopxU?si=tUt8sPAom12NYz_A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
            </div>

            <div class="panel-box">
                <div class="panel-title">
                    <span>TACTICAL MAP</span>
                    <span style="font-size:0.7rem;">TOKYO, 2026</span>
                </div>
                <ul class="loc-list">
                    <li class="loc-item" data-title="ì´ì¹˜ê°€ì•¼ (HQ / ARK)" data-desc="íŠ¹ëŒ€ë³¸ ë³¸ë¶€ ë° ì§€í•˜ ìˆ™ì†Œ 'ì•„í¬(Ark)'. ëª¨ë“  ì‘ì „ì˜ ì‹¬ì¥ë¶€ ì—­í• ì„ í•˜ëŠ” ì¤‘ì¶” ì‹œì„¤.">
                        <span class="loc-icon">ğŸ¢</span><span>ì´ì¹˜ê°€ì•¼ (HQ / ARK)</span><span class="loc-status st-safe">SAFE</span>
                    </li>
                    <li class="loc-item" data-title="ì‹ ì£¼ì¿  (Ground Zero)" data-desc="10ë…„ ì „ 'ì‹ ì£¼ì¿  ëŒ€ì¬í•´'ì˜ ì›ì . ê²Œì´íŠ¸ì˜ ì”ì¬ê°€ ë‚¨ì•„ìˆëŠ” ìµœê³  ìœ„í—˜ êµ¬ì—­ìœ¼ë¡œ, ë¯¼ê°„ì¸ ì¶œì…ì´ ì—„ê²©íˆ í†µì œëœë‹¤.">
                        <span class="loc-icon">âš ï¸</span><span>ì‹ ì£¼ì¿  (Ground Zero)</span><span class="loc-status st-danger">DANGER</span>
                    </li>
                    <li class="loc-item" data-title="ì‹œë¶€ì•¼ (Operation Zone)" data-desc="ì´í˜•ì²´ê°€ ê°€ì¥ ë¹ˆë²ˆí•˜ê²Œ ì¶œëª°í•˜ëŠ” ì£¼ìš” ì‘ì „ êµ¬ì—­. ìƒì‹œ êµì „ì´ ë°œìƒí•˜ë©°, 'ë¸”ë™ ë¼ë²¨'ì˜ ì£¼ í™œë™ ë¬´ëŒ€ì´ë‹¤.">
                        <span class="loc-icon">ğŸ™ï¸</span><span>ì‹œë¶€ì•¼ (Operation Zone)</span><span class="loc-status st-warn">WARN</span>
                    </li>
                    <li class="loc-item" data-title="ì˜¤ë‹¤ì´ë°” (Isolation)" data-desc="ì¸ê³µì„¬ì— ìœ„ì¹˜í•œ íŠ¹ìˆ˜ ê²©ë¦¬ ë° í›ˆë ¨ ì‹œì„¤. í†µì œê°€ ì–´ë ¤ìš´ ê³ ìœ„í—˜êµ° ì„¼í‹°ë„¬ì„ ê²©ë¦¬í•˜ê±°ë‚˜ íŠ¹ìˆ˜ í›ˆë ¨ì„ ì§„í–‰í•˜ëŠ” ê³³ì´ë‹¤.">
                        <span class="loc-icon">ğŸ”¬</span><span>ì˜¤ë‹¤ì´ë°” (Isolation)</span><span class="loc-status st-warn">RESTRICT</span>
                    </li>
                </ul>
            </div>

            <div class="panel-box">
                <div class="panel-title">
                    <span>REGULATIONS</span>
                    <span style="color:var(--alert);">MANDATORY</span>
                </div>
                <div style="font-size:0.8rem; color:#aaa; line-height:1.5;">
                    <p><strong>[ì œ0ê¸°ë™ë¶€ëŒ€ ìˆ˜ì¹™]</strong></p>
                    <p>1. í†µì œìš© ì´ˆì»¤ ìƒì‹œ ì°©ìš©.<br>
                    2. ë¯¼ê°„ì¸ í”¼í•´ ë°œìƒ ì‹œ ì¦‰ì‹œ ì§•ê³„.<br>
                       - ë“±ê¸‰ ê°•ë“± ë° ê°€ì´ë”© ë°°ê¸‰ ì œí•œ.<br>
                    3. ëª…ë ¹ ë¶ˆë³µì¢… ì‹œ ê°•ì œ ì§„ì •ì œ íˆ¬ì—¬.</p>
                </div>
            </div>

            <div class="panel-box" style="flex:1; display:flex; flex-direction:column;">
                <div class="panel-title">SYSTEM LOGS</div>
                <div id="sys-log" class="log-window"></div>
            </div>
        </div>

        <div class="squad-section">
            <div class="grid-header">
                <div>
                    <div class="grid-title">BLACK LABEL SQUAD</div>
                    <div style="font-size:0.8rem; color:#666;">SPECIAL FORCES UNIT 0</div>
                </div>
                <div class="grid-sub">â— LIVE FEED CONNECTED</div>
            </div>
            <div class="char-grid" id="char-grid">
            </div>
        </div>
    </div>

    <div id="detail-modal" class="modal-overlay hidden">
        <div class="modal-box">
            <div class="modal-header">
                <div>
                    <h2 id="dt-name" style="margin:0; color:white;">NAME</h2>
                    <span id="dt-role" style="color:var(--alert); font-weight:bold;">ROLE</span>
                </div>
                <button onclick="closeDetail()" style="padding:5px 15px;">CLOSE X</button>
            </div>
            <div class="modal-body">
                <div class="view-left">
                    <img id="dt-main-img" src="" class="main-img-view">
                    
                    <div class="info-block">
                        <div class="info-label">GALLERY</div>
                        <div class="gallery-slots" id="dt-gallery"></div>
                    </div>
                    
                    <div class="info-block">
                        <div class="info-label">VOICE RECORDS</div>
                        <div class="voice-slots" id="dt-voices"></div>
                    </div>
                </div>
                <div class="view-right">
                    <div class="info-block"><div class="info-label">PROFILE</div><div id="dt-profile" class="info-content"></div></div>
                    <div class="info-block"><div class="info-label">PERSONALITY</div><div id="dt-pers" class="info-content"></div></div>
                    <div class="info-block"><div class="info-label">ABILITY</div><div id="dt-ability" class="info-content" style="color:var(--primary);"></div></div>
                    <div class="info-block"><div class="info-label">TMI</div><div id="dt-tmi" class="info-content" style="font-size:0.9rem; color:#aaa;"></div></div>
                    
                    <div class="info-block">
                        <div class="info-label">BACKGROUND STORY</div>
                        <div id="dt-story" class="spoiler-box">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="user-profile-modal" class="modal-overlay hidden">
        <div class="modal-box user-profile-box">
            <div style="font-size:1.5rem; color:var(--primary); margin-bottom:20px;">PERSONNEL FILE</div>
            <img id="user-p-img" src="" style="width:120px; height:120px; border-radius:50%; margin:0 auto; border:2px solid #fff;">
            <div style="margin-top:20px;">
                <div class="user-data-row"><span class="data-label">CODE NAME</span><span class="data-val" id="user-p-name"></span></div>
                <div class="user-data-row"><span class="data-label">RANK & CLASS</span><span class="data-val" id="user-p-role"></span></div>
                <div class="user-data-row"><span class="data-label">SPECIAL ABILITY</span><span class="data-val" id="user-p-ability"></span></div>
            </div>
            <div class="action-btn-group">
                <button onclick="copyUserInfo()">ğŸ“‹ DATA COPY</button>
                <button onclick="requestDeployment()" class="btn-alert">ğŸš¨ REQUEST DEPLOYMENT</button>
            </div>
            <button onclick="closeUserProfile()" style="margin-top:10px; border:none; background:transparent; font-size:0.8rem; color:#666;">CLOSE</button>
        </div>
    </div>

    <div id="mission-modal" class="modal-overlay hidden" style="z-index:9999;">
        <div class="modal-box mission-modal-box" style="text-align:center; padding:40px;">
            <h2 style="color:var(--alert); font-size:2rem; animation:blink 0.5s infinite;">âš ï¸ URGENT MISSION âš ï¸</h2>
            <img id="mission-char-img" class="mission-char-img" src="">
            <div style="color:var(--primary); font-weight:bold; font-size:1.2rem;" id="mission-char-name">CHARACTER NAME</div>
            <div id="mission-dialogue" class="mission-dialogue">"ëŒ€ì‚¬ ë‚´ìš©ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤."</div>
            <button onclick="acceptMission()" class="btn-alert" style="font-size:1.2rem; padding:15px 40px;">MISSION ACCEPT</button>
        </div>
    </div>

    <div id="image-popup" class="modal-overlay hidden" onclick="closeImagePopup()">
        <img id="popup-image-content" src="">
        <button class="close-btn" onclick="closeImagePopup()">CLOSE X</button>
    </div>

    <div id="voice-popup" class="modal-overlay hidden">
        <div class="modal-box">
             <p id="voice-popup-text"></p>
             <div id="voice-popup-waveform">
                 <div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div><div class="wave-bar"></div>
             </div>
             <button class="close-btn" onclick="closeVoicePopup()">CLOSE X</button>
        </div>
    </div>

    <div id="location-modal" class="modal-overlay hidden">
        <div class="modal-box" style="max-width: 500px; padding: 30px; text-align: center;">
            <h3 id="loc-modal-title" style="color:var(--primary); margin-bottom: 20px;">LOCATION INFO</h3>
            <p id="loc-modal-desc" style="color:#ccc; line-height:1.6; font-family: 'Noto Sans KR';"></p>
            <button onclick="closeLocationModal()">CLOSE</button>
        </div>
    </div>


    <script>
        const characters = [
            { 
                id: 'ren', name: "í‚¤ì‚¬ë¼ê¸° ë Œ", role: "SS Class Sentinel", 
                thumb: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769152937486_01.jpeg", 
                profile: "27ì„¸ Â· ë‚¨ì„± Â· ENTP \nì™¸í˜•: 187cm ì€ë°±ë°œ, í‘¸ë¥¸ ëˆˆë™ì. ì „ìˆ  ê³ ê¸€ê³¼ ë°©ë…ë©´ ì°©ìš©.", 
                pers: "ëŠ¥ê¸€ë§ì€ ì¸¤ë°ë ˆ. ì¸ê°„ ë¶ˆì‹ ì´ ê¹Šìœ¼ë©° íƒ€ì¸ê³¼ ê±°ë¦¬ë¥¼ ë‘”ë‹¤.", 
                ability: "[ë¬¼ì§ˆ ë¶•ê´´] ì‹œì•¼ ë‚´ ëª¨ë“  ë¬¼ì§ˆì„ ë¶„ì ë‹¨ìœ„ë¡œ ë¶„í•´/ì¬êµ¬ì„±", 
                tmi: "Like: ë‹¨ê²ƒ(ë‹¹ê³ ), ê¸¸ê³ ì–‘ì´ / Hate: ì“´ ì»¤í”¼, ìœ„ì„ ì / ğŸ”’", 
                story: `â€œë”ëŸ¬ìš´ ê²ƒë“¤ì€ ì „ë¶€ ë¶€ìˆ´ë²„ë¦¬ë©´ ê·¸ë§Œì´ì•¼. ë„ˆë„, ì´ ì©ì–´ë¹ ì§„ ì„¸ìƒë„.â€\n\në’·ê³¨ëª©ì˜ ì“°ë ˆê¸° ë”ë¯¸ ì†ì—ì„œ íƒœì–´ë‚˜, í˜ì´ ì—†ë‹¤ëŠ” ì´ìœ ë§Œìœ¼ë¡œ ì§“ë°Ÿíˆë˜ ì–´ë¦° ì‹œì ˆì€ ëë‚¬ë‹¤. ê°ì„±ê³¼ í•¨ê»˜ ì†ì— ì¥” ê²ƒì€ ì„¸ìƒ ëª¨ë“  ë¬¼ì§ˆì„ ë¨¼ì§€ë¡œ ë˜ëŒë¦¬ëŠ” íŒŒê´´ì˜ í˜. ê·¸í† ë¡ ê°ˆë§í•˜ë˜ í˜ì„ ì–»ì—ˆìœ¼ë‚˜, ëŒì•„ì˜¤ëŠ” ê²ƒì€ 'ê´´ë¬¼'ì„ í–¥í•œ ê³µí¬ì™€ ìœ„ì„ ì ì¸ ì°¬ì‚¬ë¿ì´ì—ˆë‹¤.\n\nì‚¬ëŒì„ ë¯¿ëŠë‹ˆ ê¸¸ê°€ì˜ ê³ ì–‘ì´ë¥¼ ë¯¿ê² ë‹¤ë©° ë§ˆìŒì˜ ë¬¸ì„ ë‹«ì•„ê±´ ì±„, ê·¸ëŠ” ì˜¤ëŠ˜ë„ ë‹¬ì½¤í•œ ì‚¬íƒ•ìœ¼ë¡œ ì…ì•ˆì˜ ì“´ë§›ì„ ì§€ìš´ë‹¤. í•˜ì§€ë§Œ ê³ ê¸€ ë„ˆë¨¸ì˜ ì‹œì„ ì€ ìê¾¸ë§Œ, ìœ ì¼í•˜ê²Œ ê³„ì‚° ì—†ì´ ë‹¤ê°€ì˜¤ëŠ” ëˆ„êµ°ê°€ì—ê²Œ ë¨¸ë¬¼ê¸° ì‹œì‘í–ˆë‹¤.`,
                images: [
                    "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769152937486_01.jpeg",
                    "https://via.placeholder.com/400/111/fff?text=REN_2",
                    "https://via.placeholder.com/400/111/fff?text=REN_3",
                    "https://via.placeholder.com/400/111/fff?text=REN_4",
                    "https://via.placeholder.com/400/111/fff?text=REN_5"
                ],
                voices: [
                    { line: "ã€Œì•¼, í•¨ë¶€ë¡œ ë§Œì§€ì§€ ë§ˆ. â€¦ì†ê°€ë½ ëë¶€í„° ì¬ë¡œ ë§Œë“¤ì–´ ì¤„ í…Œë‹ˆê¹Œ, ì“°ë ˆê¸° ë…€ì„ì•„.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/r1.mp3" },
                    { line: "ã€Œì•„, ì  ì¥. ë¨¸ë¦¬ê°€ ê¹¨ì§ˆ ê²ƒ ê°™ì•„â€¦. ì•¼, ë”¸ê¸° ìš°ìœ  ë‚´ë†”. ë‹¹ì¥ ê°€ì ¸ì˜¤ë¼ê³ , ì´ ì“¸ëª¨ì—†ëŠ” ë†ˆì•„!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/r2.mp3" },
                    { line: "ã€Œí•˜ì•„â€¦ ê¼´ì´ ì—‰ë§ì´ì–ì•„. â€¦ì°©ê°í•˜ì§€ ë§ˆ. ë„¤ê°€ ì£½ìœ¼ë©´ ë’·ë§›ì´ ë”ëŸ¬ìš¸ ë¿ì´ë‹ˆê¹Œ, ë©ì²­ì•„.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/r3.wav" },
                    { line: "ã€Œí•˜? ë­ì•¼ ê·¸ ì‹¤ì‹¤ ìª¼ê°œëŠ” ë‚¯ì§ì€. â€¦ì, ë†€ë¦¬ì§€ ë§ë¼ê³ ! ë¶„í•´ë˜ê¸° ì‹«ìœ¼ë©´, ëƒ‰í¼ ì… ë‹¤ë¬¼ì–´!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/r4.mp3" },
                    { line: "ã€Œâ€¦ì¹«, ê¸°ì–´ì´ ë§í•˜ê²Œ ì‹œí‚¤ëƒ. ë‚˜ì˜ ã€ë‹¬ë§ã€ì´ ë¼ë„ ì¢‹ì€ ê±´, ë„¤ë…€ì„ë¿ì´ë‹¤. â€¦ê±°ë¶€ê¶Œ ë”°ìœˆ ì—†ë‹¤ê³ ?ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/r5.mp3" }
                ],
                missionLine: "ã€Œí•˜ì•„... ê·€ì°®ê²Œ ëë„¤. ë„¤ê°€ í•„ìš”í•´. ë©í•˜ë‹ˆ ìˆì§€ ë§ê³  ë”°ë¼ì™€.ã€" 
            },
            { 
                id: 'tatsuya', name: "ì¿ ë¡œí‚¤ íƒ€ì¸ ì•¼", role: "S Class Sentinel", 
                thumb: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769157789986_01.jpeg", 
                profile: "28ì„¸ Â· ë‚¨ì„± Â· ISTJ \nì™¸í˜•: 185cm í‘ë°œ, íšŒìƒ‰ ëˆˆ. ê° ì¡íŒ êµ°ì œë³µ.", 
                pers: "ê·¹ë„ì˜ ê³¼ë¬µí•¨. ë‹¹ì‹ ì˜ ì†Œê¿‰ì¹œêµ¬ì´ì ìƒì–´ë²„ë¦° ì²«ì‚¬ë‘.", 
                ability: "[ê·¸ë¦¼ì ì¡°ì‘] ê·¸ë¦¼ì ë¬´ê¸°í™”, ì€ì‹ , ì´ë™", 
                tmi: "Like: ê·œìœ¨, ì„œì˜ˆ / Hate: ì†Œë€, ë§¤ìš´ ê²ƒ / ğŸ”’", 
                story: `â€œë§ì€ í•„ìš” ì—†ìŠµë‹ˆë‹¤. ë‚´ ê·¸ë¦¼ìê°€ ë‹¹ì‹ ì˜ ë°©íŒ¨ê°€ ë  í…Œë‹ˆ.â€\n\nì§€í‚¤ê³  ì‹¶ì—ˆë˜ ì†Œì¤‘í•œ ì‚¬ëŒì„ ìƒì€ ë‚ , ì†Œë…„ì˜ ì‹œê°„ì€ ë©ˆì·„ë‹¤. ë‹¿ì§€ ëª»í•œ ì²«ì‚¬ë‘ì€ ê¹Šì€ ì£„ì±…ê°ì´ ë˜ì—ˆê³ , ê·¸ëŠ” ì†ì£„í•˜ë“¯ ìì‹ ì„ ê·¹í•œìœ¼ë¡œ ëª°ì•„ë¶™ì´ë©° ê°ì •ì„ ì£½ì˜€ë‹¤. ê·¸ë¦¼ì ì†ì— ìˆ¨ì–´ ì˜¤ì§ ì„ë¬´ì™€ ê·œìœ¨ë§Œì„ ë”°ë¥´ëŠ” ê¸°ê³„ê°€ ë˜ê¸°ë¥¼ ìì²˜í–ˆë˜ ë‚¨ì.\n\nê¸°ì ì²˜ëŸ¼ ë‹¤ì‹œ ë§Œë‚œ 'ë‹¹ì‹ ' ì•ì—ì„œ, ì–µëˆŒëŸ¬ì™”ë˜ ê°ˆì¦ì€ ê±·ì¡ì„ ìˆ˜ ì—†ì´ í„°ì ¸ ë‚˜ì˜¨ë‹¤. ì´ë²ˆì—ì•¼ë§ë¡œ ì ˆëŒ€ ë†“ì¹˜ì§€ ì•Šê² ë‹¤ëŠ” ë“¯, ê·¸ì˜ ê·¸ë¦¼ìëŠ” ì–´ëŠ ë•Œë³´ë‹¤ ì§™ê³  ê±°ëŒ€í•˜ê²Œ ë‹¹ì‹ ì˜ ë°œë°‘ì„ ì§€í‚¤ê³  ìˆë‹¤.`,
                images: Array(5).fill("https://via.placeholder.com/400/222/fff?text=TATSUYA"), 
                voices: [
                    { line: "ã€Œëª©í‘œ í™•ì¸. â€¦ê·¸ë¦¼ìì— ìˆ˜ì¥ì‹œí‚¨ë‹¤.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/t1.mp3" },
                    { line: "ã€Œë‚´ ë’¤ì— ìˆì–´. â€¦ë‘ ë²ˆ ë‹¤ì‹œ, ìƒì„ ìˆ˜ëŠ” ì—†ì–´.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/t2.mp3" },
                    { line: "ã€Œë¼ì ¸. ì¦‰ì‹œ ìˆ˜í–‰í•œë‹¤.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/t3.mp3" },
                    { line: "ã€Œë‹¨ì¶”ê°€ ëŠìŠ¨í•´ì¡Œêµ°. â€¦ì´ë¦¬ ì¤˜, ë‚´ê°€ ê³ ì¹˜ì§€.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/t4.mp3" },
                    { line: "ã€Œê·¸ë¦¼ìì²˜ëŸ¼, ê³„ì† ê³ì— ìˆê² ë‹¤. â€¦ë„¤ê°€, ë‚˜ì˜ ë¹›ì´ë‹ˆê¹Œ.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/t5.mp3" }
                ], 
                missionLine: "ã€Œì „ë°©ì— ì  ë‹¤ìˆ˜ í™•ì¸. ì§€ì›ì´ í•„ìš”í•˜ë‹¤. ...ë‚´ ë“± ë’¤ëŠ” ë„ˆì—ê²Œ ë§¡ê¸°ì§€.ã€" 
            },
            { 
                id: 'leo', name: "ì•„ì¹´ê¸° ë ˆì˜¤", role: "A+ Class Sentinel", 
                thumb: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769158086663_01.jpeg", 
                profile: "28ì„¸ Â· ë‚¨ì„± Â· ESFP \nì™¸í˜•: 188cm ë¶‰ì€ ì˜¬ë°±ë¨¸ë¦¬, ê¸ˆì•ˆ. ìŠ¤ì¹´ì” ì°©ìš©.", 
                pers: "ë‹¨ì„¸í¬ ë³¸ëŠ¥íŒŒ. ì „ì§ í­ì£¼ì¡± ì´ì¥. ì‹¸ì›€ê³¼ ê³ ê¸° ì™¸ì—” ê´€ì‹¬ ì—†ë‹¤.", 
                ability: "[í‘¸ë¥¸ í™”ì—¼] ì œì–´ ë¶ˆê°€ëŠ¥í•œ ê³ ì—´ì˜ í‘¸ë¥¸ ë¶ˆê½ƒ", 
                tmi: "Like: ì•¼í‚¤ë‹ˆì¿ , ë°”ì´í¬ / Hate: ì±„ì†Œ, ìœ ë ¹ / ğŸ”’", 
                story: `â€œë³µì¡í•œ ê±´ ë”± ì§ˆìƒ‰ì´ì•¼. í™”ëˆí•˜ê²Œ ì „ë¶€ íƒœì›Œë²„ë¦¬ê³  ê³ ê¸°ë‚˜ ë¨¹ìœ¼ëŸ¬ ê°€ìê³ !â€\n\nì˜¤ì‚¬ì¹´ì˜ ë°¤ê±°ë¦¬ë¥¼ ì§€ë°°í•˜ë˜ í­ì£¼ì¡± ì´ì¥, ë¶‰ì€ ë¨¸ë¦¬ì˜ ì•¼ìˆ˜ê°€ ì „ì¥ì„ ë‹¬ë¦°ë‹¤. ê·¸ì—ê²Œ ì„¸ìƒì€ ë³µì¡í•œ ë…¼ë¦¬ê°€ ì•„ë‹Œ, 'ë‚´ í¸'ê³¼ 'ì 'ìœ¼ë¡œ ë‚˜ë‰˜ëŠ” ë‹¨ìˆœí•œ ê³³ì´ë‹¤. ì œì–´í•  ìˆ˜ ì—†ì„ ë§Œí¼ ëœ¨ê±°ìš´ í‘¸ë¥¸ í™”ì—¼ì€ ë‹¿ëŠ” ëª¨ë“  ê²ƒì„ ì¬ë¡œ ë§Œë“¤ì§€ë§Œ, ê·¸ë§Œí¼ ìˆœìˆ˜í•œ ì—´ì •ì´ê¸°ë„ í•˜ë‹¤.\n\në¨¸ë¦¬ ì“°ëŠ” ì¼ì€ ì§ˆìƒ‰ì´ë¼ë©° íˆ¬ëœëŒ€ë©´ì„œë„, í•œë²ˆ ì¸ì •í•œ ìƒëŒ€ì—ê²ŒëŠ” ë’¤ë„ ëŒì•„ë³´ì§€ ì•Šê³  ë“±ì„ ë§¡ê¸´ë‹¤. êµ‰ìŒê³¼ ì—´ê¸°, ê·¸ë¦¬ê³  í”¼ ëƒ„ìƒˆê°€ ì§„ë™í•˜ëŠ” ì „ì¥ì€ ì´ì œ ê·¸ê°€ ë§ˆìŒê» ë‚ ë›¸ ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë†€ì´í„°ê°€ ë˜ì—ˆë‹¤.`,
                images: Array(5).fill("https://via.placeholder.com/400/311/fff?text=LEO"), 
                voices: [
                    { line: "ã€Œì•„ ì”¨, ëª°ë¼! ë³µì¡í•œ ì–˜ê¸°ëŠ” ì¹˜ì•„ë¼! ëˆ„êµ´ ì¡°ì§€ë©´ ë˜ëŠ” ê±´ë°, ì–´?!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/l11.mp3" },
                    { line: "ã€Œìš•ë´¤ë‹¤! ì¼ ëë‚˜ë©´ ê³ ê¸° ë¬µìœ¼ëŸ¬ ê°€ì! ì˜¤ëŠ˜ì€ ì´ í˜•ë‹˜ì´ ìœë‹¤!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/l2.mp3" },
                    { line: "ã€Œë‹ˆ, ê¹¡ë‹¤êµ¬ í•˜ë‚˜ëŠ” ì§ì´ë„¤! ë‚´ ë§ˆìŒì— ì™ ë“¤ì—ˆë‹¤!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/l3.wav" },
                    { line: "ã€Œë‚´ íŒŒë€ ë¶ˆê½ƒì€ ë§ˆì´ ëœ¨ê²ë‹¤! í™”ìƒ ì…ëŠ” ì •ë„ë¡œ ì•ˆ ëë‚  ë¼ë‹¤!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/l4.mp3" },
                    { line: "ã€Œë‹ˆ ì–¼êµ´ë§Œ ë³´ë¯„, ì˜¤í† ë°”ì´ë³´ë‹¤ ì‹¬ì¥ ì—”ì§„ ì†Œë¦¬ê°€ ë” ìš”ë€í•˜ë‹¤ ì•ˆ ì¹´ë‚˜! â€¦í™• ë‚´ ê¹” í•´ë¼, ë§ˆ!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/l5.mp3" }
                ], 
                missionLine: "ã€Œì˜¤! ë“œë””ì–´ ëª¸ ì¢€ í‘¸ëŠ” ê±°ëƒ? ì–´ì´! ëŠ¦ìœ¼ë©´ ë‘ê³  ê°„ë‹¤? ê½‰ ì¡ì•„!!ã€" 
            },
            { 
                id: 'kei', name: "ë¯¸ë‚˜ë¯¸ ì¼€ì´", role: "S Class Sentinel (Admin)", 
                thumb: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769158477048_01.jpeg", 
                profile: "39ì„¸ Â· ë‚¨ì„± Â· INFJ \nì™¸í˜•: 183cm í‘ë°œ, ì‹¤ëˆˆ(ê°œì•ˆ ì‹œ ë…¹ì•ˆ). ìˆ˜íŠ¸ ì°©ìš©.", 
                pers: "ì˜¨í™”í•œ ê°€ë©´ ë’¤ì˜ ëƒ‰í˜ˆí•œ.", 
                ability: "[êµ¬ì†ì˜ ì‚¬ìŠ¬] ê³µê°„ì—ì„œ ì‡ ì‚¬ìŠ¬ ì†Œí™˜, êµ¬ì† ë° ì ˆë‹¨", 
                tmi: "Like: ë‹¤ë¦¼ì§ˆ, í™ì°¨ / Hate: ìˆ , ë¬´ë¡€í•¨ / ğŸ”’", 
                story: `â€œê±±ì • ë§ì•„ìš”. ëª¨ë“  ê±´ ì œ í†µì œ í•˜ì— ìˆìœ¼ë‹ˆê¹Œ... ì°¨ í•œ ì” ë“œì‹œê² ìŠµë‹ˆê¹Œ?â€\n\nì˜¨í™”í•œ ë¯¸ì†Œ, ì™„ë²½í•œ ë§¤ë„ˆ, ííŠ¸ëŸ¬ì§ ì—†ëŠ” ìˆ˜íŠ¸ í•. ê·¸ëŠ” ëˆ„êµ¬ì—ê²Œë‚˜ ì¹œì ˆí•œ ê´€ë¦¬ê´€ì´ì§€ë§Œ, ê·¸ ë¯¸ì†ŒëŠ” ì² ì €í•˜ê²Œ ê³„ì‚°ëœ ê°€ë©´ì¼ ë¿ì´ë‹¤. ì´í˜•ì²´ì—ê²Œ ì‚¬ë‘í•˜ëŠ” ì•„ë‚´ì™€ ì•„ì´ë“¤ì„ ìƒê³  ì„¸ìƒì´ ë¬´ë„ˆì ¸ ë‚´ë¦° ê·¸ë‚ , ê·¸ëŠ” ìŠ¤ìŠ¤ë¡œì˜ ê°ì •ì— 'êµ¬ì†ì˜ ì‚¬ìŠ¬'ì„ ì±„ì› ë‹¤.\n\në§¤ì¼ ë°¤ ìŠµê´€ì²˜ëŸ¼ ì£½ì€ ê°€ì¡±ì„ ìœ„í•œ 4ì¸ë¶„ì˜ ìš”ë¦¬ë¥¼ ë§Œë“¤ê³  í™€ë¡œ ì‹íƒì— ì•‰ëŠ” ë‚¨ì. ë‹¤ì •í•œ ëˆˆì›ƒìŒ ë’¤ì—ëŠ” ì„¸ìƒì„ í–¥í•œ ë”ì°í•œ ì¦ì˜¤ì™€, ì–¸ì  ê°€ ë§ì´í•  íŒŒêµ­ì„ ê¸°ë‹¤ë¦¬ëŠ” ì„œëŠ˜í•œ ì ˆë§ì´ ë„ì‚¬ë¦¬ê³  ìˆë‹¤.`,
                images: Array(5).fill("https://via.placeholder.com/400/020/fff?text=KEI"), 
                voices: [
                    { line: "ã€Œë‚ ë›°ì§€ ë§ì•„ ì£¼ì„¸ìš”. ê¸ˆë°© í¸í•˜ê²Œ í•´ ë“œë¦´ í…Œë‹ˆê¹Œ.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/k1.mp3" },
                    { line: "ã€Œâ€¦ë¹„íš¨ìœ¨ì ì´êµ°ìš”. ê³„íšëŒ€ë¡œ ì›€ì§ì—¬ ì£¼ì‹œê² ìŠµë‹ˆê¹Œ?ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/k2.mp3" },
                    { line: "ã€Œì´ëŸ°, ë‹¤ì¹œ ê³³ì€ ì—†ë‚˜ìš”? â€¦í›„í›„, ê±±ì •ì´ ë§ì•„ì„œ ë¯¸ì•ˆí•©ë‹ˆë‹¤.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/k3.mp3" },
                    { line: "ã€Œì œ í—ˆìš© ë²”ìœ„ë¥¼ ë„˜ì§€ ë§ˆì„¸ìš”. â€¦ë¶€ìˆ´ë²„ë¦¬ê³  ì‹¶ì–´ì§€ê±°ë“ ìš”.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/k4.mp3" },
                    { line: "ã€Œì°¨ë¼ë¦¬, ì–´ë””ì—ë„ ëª» ê°€ê²Œ ì‚¬ìŠ¬ë¡œ ë¬¶ì–´ë‘ê³  ì‹¶ë„¤ìš”. â€¦í›„í›„, ë†ë‹´ì…ë‹ˆë‹¤.ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/k5.mp3" }
                ], 
                missionLine: "ã€Œìƒí™©ì´ ì¢‹ì§€ ì•Šêµ°ìš”. ë‹¹ì‹ ì˜ ëŠ¥ë ¥ì´ ì ˆì‹¤í•©ë‹ˆë‹¤. ë¶€ë””, ì €ë¥¼ ë„ì™€ì£¼ì‹œê² ìŠµë‹ˆê¹Œ?ã€" 
            },
            { 
                id: 'izumi', name: "í˜¸ì‹œë…¸ ì´ì¦ˆë¯¸", role: "A+ Class Sentinel", 
                thumb: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/1769159689233_01.jpeg", 
                profile: "23ì„¸ Â· ë‚¨ì„± Â· ESTP \nì™¸í˜•: 190cm ì§„ë¶„í™ íŒ, ì—°ë‘ìƒ‰ ëˆˆ. í—¤ë“œì…‹ ì°©ìš©.", 
                pers: "í†µì œë¶ˆëŠ¥ í­íŒŒê´‘. ì „ì¥ì„ ë†€ì´í„°ë¡œ ìƒê°í•˜ëŠ” ë¹„ê¸€ë¯¸ ë„˜ì¹˜ëŠ” ë¬¸ì œì•„.", 
                ability: "[ë¸”ë˜ìŠ¤íŠ¸ & ì•„ìŠ¤ë„] ì†ì— ì¥” ë¬´ê¸° í™”ë ¥ ê·¹ëŒ€í™”", 
                tmi: "Like: ê³ ì¹´í˜ì¸, í­ë°œìŒ / Hate: ì •ì  / ğŸ”’", 
                story: `â€œì•„í•˜í•˜! ë¹µë¹µ í„°ì ¸ë¼! ì—¬ê¸°ê°€ ë‚´ ë¬´ëŒ€ê³ , ì € ë†ˆë“¤ì´ í­ì£½ì´ì•¼!â€\n\ní†µì œ ë¶ˆëŠ¥, êµ¬ì œ ë¶ˆëŠ¥. ëª¨ë“  êµìœ¡ ê¸°ê´€ì—ì„œ í‡´ì¶œë‹¹í•œ ë¬¸ì œì•„ì—ê²Œ ë¸”ë™ ë¼ë²¨ì€ ì²œêµ­ì´ì—ˆë‹¤. ë‚¨ë“¤ì—ê²ŒëŠ” ê³µí¬ì¸ ì „ì¥ì˜ í¬í™”ê°€ ê·¸ì—ê²ŒëŠ” ì‹ ë‚˜ëŠ” ë¦¬ë“¬ ê²Œì„ì˜ ë¹„íŠ¸ì™€ë„ ê°™ë‹¤. ê±°ëŒ€í•œ ë¯¸ë‹ˆê±´ 'ìº”ë””'ë¥¼ ê»´ì•ˆê³  ê´‘ê¸° ì–´ë¦° ì›ƒìŒì„ í„°íŠ¸ë¦´ ë•Œ, ê·¸ëŠ” ë¹„ë¡œì†Œ ì‚´ì•„ìˆìŒì„ ëŠë‚€ë‹¤.\n\nì‹œë„ëŸ¬ìš´ í­ë°œìŒ ì†ì—ì„œë§Œ ì•ˆì •ì„ ì°¾ëŠ” ëª¨ìˆœì ì¸ ì†Œë…„. í•˜ì§€ë§Œ ê´‘ë€ì˜ ì „íˆ¬ê°€ ëë‚˜ê³  í—¤ë“œì…‹ì„ ëˆŒëŸ¬ ì¼ì„ ë•Œ, ê·¸ ì•ˆì—ì„œ í˜ëŸ¬ë‚˜ì˜¤ëŠ” ê³¡ì€ ì˜ì™¸ë¡œ ì”ì”í•œ í”¼ì•„ë…¸ ì„ ìœ¨ì´ë‹¤.`,
                images: Array(5).fill("https://via.placeholder.com/400/202/fff?text=IZUMI"), 
                voices: [
                    { line: "ã€Œë´ë´! ë‚´ 'ìº”ë””' ì§±, ì™„ì „ ê·€ì—½ì§€?ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/i1.mp3" },
                    { line: "ã€Œì•„~ ì‹¬ì‹¬í•´ì„œ ì£½ì„ ê²ƒ ê°™ì•„~. ì €ê¸°, í­íŒŒí•´ë„ ë¼? â€¦ë˜ì§€?ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/i2.mp3" },
                    { line: "ã€Œë¦¬ë¡œë“œ ì™„ë£Œ! ì, ë²Œì§‘ì´ ë˜ì–´ë²„ë ¤ë¼! ì•„í•˜í•˜í•˜!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/i3.mp3" },
                    { line: "ã€Œê²Œì„ ì˜¤ë²„! ìœ ê°ì´ë„¤, ë„ˆì˜ íŒ¨ë°°ì•¼! ë°”ì´ë°”~ì´!ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/i4.mp3" },
                    { line: "ã€Œìˆì§€, í­íƒ„ ì¹´ìš´íŠ¸ë‹¤ìš´ë³´ë‹¤, ë„ˆë¥¼ ë³´ê³  ìˆëŠ” ê²Œ ë” ë‘ê·¼ê±°ë ¤! â€¦ë‚˜ë‘ 'ìœ„í—˜í•œ ì§“' í•´ë³´ì§€ ì•Šì„ë˜?ã€", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/i5.mp3" }
                ], 
                missionLine: "ã€Œì•¼í˜¸!! í­ì£½ë†€ì´ ì‹œê°„ì´ë‹¤!! í˜•ì”¨! ë‚˜ë‘ ê°™ì´ ì‹¹ ë‹¤ ë‚ ë ¤ë²„ë¦¬ëŸ¬ ê°€ìê³ !!ã€" 
            }
        ];
        const audioSrc = { story: ["https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(8).WAV", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(2).WAV", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(3).WAV", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(4).WAV", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(9).WAV"], renIntro: ["https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(1).WAV", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(6).WAV", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/0125(7).WAV"], bgmList: [{ title: "BGM 01", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/tokyo.wav" }, { title: "BGM 02", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/tokyo%20(1).wav" }, { title: "BGM 03", url: "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/tokyo%20(2).wav" }] };
        const storyImg = ["https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/d1.jpeg", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/d2.jpeg", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/d3.jpeg", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/d4.jpeg", "https://pub-3c8fae18419a4334951c13e85cb211b0.r2.dev/d5.jpeg"];
        const storyText = ["10ë…„ ì „, ì¼ë³¸ ìƒê³µì— ê±°ëŒ€í•œ ì°¨ì› ê· ì—´ 'ê²Œì´íŠ¸'ê°€ ì—´ë ¸ë‹¤.", "ê· ì—´ì—ì„œ ìŸì•„ì ¸ ë‚˜ì˜¨ ì´í˜•ì²´ë“¤ì€\nìˆœì‹ê°„ì— ë„ì‹œë¥¼ ë¶ˆë°”ë‹¤ë¡œ ë§Œë“¤ì—ˆë‹¤.", "ì¸ë¥˜ëŠ” ëŒ€í•­í•˜ê¸° ìœ„í•´ ì´ˆëŠ¥ë ¥ì 'ì„¼í‹°ë„¬'ì„ ê°ì„±ì‹œì¼°ê³ ...", "ì •ë¶€ëŠ” ì´ë“¤ì„ í†µì œí•˜ê¸° ìœ„í•´\n'íŠ¹ì´ í˜„ìƒ ëŒ€ì±… ë³¸ë¶€'ë¥¼ ì„¤ë¦½í–ˆë‹¤.", "ê·¸ë¦¬ê³  ì´ê³³, ê°€ì¥ ìœ„í—˜í•œ ì„ë¬´ë¥¼ ìˆ˜í–‰í•˜ëŠ”\ní†µì œ ë¶ˆëŠ¥ì˜ ë¶€ëŒ€ 'ë¸”ë™ ë¼ë²¨'ì´ ìˆë‹¤."];

        const sfx = { 
            hover: document.getElementById('sfx-hover'), 
            click: document.getElementById('sfx-click'), 
            type: document.getElementById('sfx-type'), 
            scan: document.getElementById('sfx-scan'), 
            access: document.getElementById('sfx-access'), 
            alarm: document.getElementById('sfx-alarm') 
        };
        const narr = document.getElementById('narr-player');
        const bgm = document.getElementById('bgm-player');
        const voicePlayer = document.getElementById('voice-player');
        let userData = {};
        
        let isAudioUnlocked = false;

        const bootBar = document.getElementById('boot-bar');
        const bootText = document.getElementById('boot-text');
        let bootVal = 0;
        const bootInterval = setInterval(() => {
            bootVal += Math.random() * 5; if(bootVal > 100) bootVal = 100;
            bootBar.style.width = bootVal + '%';
            bootText.innerText = `LOADING CORE MODULES... ${Math.floor(bootVal)}%`;
            if(bootVal === 100) { clearInterval(bootInterval); bootText.innerText = "SYSTEM READY"; document.getElementById('start-btn-group').classList.remove('hidden'); }
        }, 80);

        function unlockAudioContext() {
            if (isAudioUnlocked) return;
            Object.values(sfx).forEach(sound => {
                sound.volume = 0;
                sound.play().catch(()=>{});
                sound.pause();
                sound.currentTime = 0;
                sound.volume = 1;
            });
            isAudioUnlocked = true;
            console.log("Audio Context Unlocked.");
        }
        
        function playSound(soundKey, options = {}) {
            if (!isAudioUnlocked || !sfx[soundKey]) return;
            const sound = sfx[soundKey];
            sound.loop = options.loop || false;
            sound.volume = options.volume || 1.0;
            sound.currentTime = 0;
            sound.play().catch(e => console.error(`Error playing ${soundKey}:`, e));
        }
        
        function stopSound(soundKey) {
            if (!sfx[soundKey]) return;
            sfx[soundKey].pause();
            sfx[soundKey].currentTime = 0;
        }

        document.getElementById('btn-init').addEventListener('click', () => { 
            unlockAudioContext();
            playSound('click');
            document.getElementById('start-screen').style.display = 'none'; 
            playBGM(0); 
            playStory(); 
        });

        let skipStory = false;
        async function playStory() {
            const screen = document.getElementById('story-screen');
            const imgEl = document.getElementById('story-img');
            const imgContainer = imgEl.parentElement;
            const txt = document.getElementById('story-text');
            const skipBtn = document.getElementById('skip-btn');
            screen.classList.remove('hidden');
            skipStory = false;
            skipBtn.onclick = () => { 
                playSound('click');
                skipStory = true; 
                narr.pause(); 
                screen.classList.add('hidden'); 
                runIntro(); 
            };
            for (let i = 0; i < storyText.length; i++) {
                if(skipStory) break;
                imgEl.src = storyImg[i];
                imgContainer.style.setProperty('--glitch-image', `url(${storyImg[i]})`);
                txt.innerText = storyText[i];
                narr.src = audioSrc.story[i];
                narr.play().catch(()=>{});
                await new Promise(resolve => {
                    narr.onended = resolve;
                    const checkSkip = setInterval(() => { if(skipStory){ clearInterval(checkSkip); resolve(); } }, 100);
                });
                if(skipStory) break;
                await new Promise(r => setTimeout(r, 500));
            }
            if(!skipStory) { screen.classList.add('hidden'); runIntro(); }
        }

        async function runIntro() {
            const bridge = document.getElementById('bridge-screen');
            bridge.classList.remove('hidden');
            await new Promise(r => setTimeout(r, 2000));
            bridge.classList.add('hidden');
            document.getElementById('intro-screen').classList.remove('hidden');
            const boxContent = document.getElementById('msg-content');
            const waveform = document.getElementById('voice-waveform');
            waveform.classList.remove('hidden');
            narr.src = audioSrc.renIntro[0]; narr.play().catch(()=>{});
            await typeText(boxContent, "ë Œï½œã€Œì–´ì´, ì •ì‹  ì¢€ ì°¨ë¦¬ì‹œì§€. ì´ëŸ° ë°ì„œ ë„‹ ë†“ê³  ìˆì§€ ë§ë¼ê³ , ë©ì²­ì•„.ã€");
            await new Promise(r => narr.onended = r);
            narr.src = audioSrc.renIntro[1]; narr.play().catch(()=>{});
            await typeText(boxContent, "ë Œï½œã€Œì—¬ê¸°ëŠ” 'íŠ¹ëŒ€ë³¸'ì´ì•¼. â€¦â€¦ë­, ê¸°ê»í•´ì•¼ ì§€ì˜¥ ì…êµ¬ë¼ê³  ë¶€ë¥´ëŠ” ê²Œ ì–´ìš¸ë¦¬ëŠ” ê³³ì´ì§€ë§Œ ë§ì´ì•¼.ã€");
            await new Promise(r => narr.onended = r);
            narr.src = audioSrc.renIntro[2]; narr.play().catch(()=>{});
            boxContent.innerHTML = "ë Œï½œã€Œë„ˆë„ 'ê°ì„±ì'ì§€?â€¦â€¦ ì, ë¹¨ë¦¬ ì´ë¦„ì´ë‚˜ ëŒ€ì‹œì§€. ì“°ë ˆê¸°ë“¤ ë¦¬ìŠ¤íŠ¸ì— ì˜¬ë ¤ì¤„ í…Œë‹ˆê¹Œ.ã€";
            
            setTimeout(() => {
                document.getElementById('input-area').classList.remove('hidden');
                applyHoverSound(document.querySelectorAll('.avatar-opt, button'));
                setTimeout(() => {
                    waveform.classList.add('hidden');
                }, 1500);
            }, 500);
        }

        async function typeText(target, text) {
            target.innerHTML = ''; 
            for(let char of text) { 
                target.innerHTML += char; 
                playSound('type', {volume: 0.5});
                await new Promise(r=>setTimeout(r, (char === '\n' ? 400 : 40))); 
            }
        }

        function selectAvatar(gender, url, el) { 
            userData.gender = gender; 
            userData.avatar = url; 
            document.querySelectorAll('.avatar-opt').forEach(opt => opt.classList.remove('active')); 
            el.classList.add('active'); 
            playSound('click');
        }
        function submitForm(role) {
            playSound('click');
            const name = document.getElementById('user-name').value;
            const age = document.getElementById('user-age').value;
            if(!userData.gender) return alert("ì•„ë°”íƒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
            if(!name || !age) return alert("ì´ë¦„ê³¼ ë‚˜ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            userData.name = name; userData.age = age; userData.role = role;
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('scan-screen').classList.remove('hidden');
        }

        const scanner = document.getElementById('hand-scanner');
        let scanTimer, scanVal = 0;
        scanner.addEventListener('mousedown', (e) => { e.preventDefault(); startScan(); });
        scanner.addEventListener('mouseup', endScan);
        scanner.addEventListener('mouseleave', endScan);
        scanner.addEventListener('touchstart', (e) => { e.preventDefault(); e.stopPropagation(); startScan(); }, { passive: false });
        scanner.addEventListener('touchend', (e) => { e.preventDefault(); endScan(); });
        scanner.oncontextmenu = function(e) { e.preventDefault(); e.stopPropagation(); return false; };

        function startScan() {
            if(scanner.classList.contains('scanning')) return;
            playSound('scan', {loop: true});
            scanner.classList.add('scanning');
            document.getElementById('radar').style.display = 'block';
            document.getElementById('scan-status').innerText = "ANALYZING BIOMETRICS...";
            document.getElementById('scan-status').style.color = "var(--primary)";
            scanTimer = setInterval(() => { scanVal += 2; if(scanVal >= 100) completeScan(); }, 50);
        }
        function endScan() {
            if(scanVal < 100) { clearInterval(scanTimer); scanVal = 0; stopSound('scan'); scanner.classList.remove('scanning'); document.getElementById('radar').style.display = 'none'; document.getElementById('scan-status').innerText = "SCAN ABORTED"; document.getElementById('scan-status').style.color = "var(--alert)"; }
        }
        function completeScan() {
            clearInterval(scanTimer); 
            stopSound('scan');
            playSound('access');
            const ranks = ["SS", "S", "A", "B"];
            userData.rank = ranks[Math.floor(Math.random()*ranks.length)];
            userData.ability = userData.role === 'GUIDE' ? "ê°€ì´ë”© (Guiding)" : ["ì—¼ë™ë ¥", "ìˆœê°„ì´ë™", "ì •ì‹ ê°ì‘", "ì‹ ì²´ê°•í™”"].sort(()=>0.5-Math.random())[0];
            document.getElementById('result-rank').innerText = userData.rank;
            document.getElementById('result-ability').innerText = userData.ability;
            document.getElementById('result-modal').classList.remove('hidden');
            document.body.classList.add('modal-open');
            applyHoverSound(document.querySelectorAll('#result-modal button'));
        }
        function enterDashboard() { 
            playSound('click');
            document.getElementById('result-modal').classList.add('hidden');
            document.body.classList.remove('modal-open');
            document.getElementById('scan-screen').classList.add('hidden'); 
            document.getElementById('main-dashboard').classList.remove('hidden'); 
            document.getElementById('control-bar').classList.remove('hidden'); 
            initDashboard(); 
        }
        function initDashboard() {
            const grid = document.getElementById('char-grid');
            characters.forEach(c => {
                const card = document.createElement('div');
                card.className = 'char-card'; card.onclick = () => openDetail(c);
                card.innerHTML = `<div class="card-img-wrap"><img src="${c.thumb}" class="card-img"><div class="vital-line"><div class="ecg"></div></div><div class="status-badge">ON MISSION</div></div><div class="card-info"><div class="card-name">${c.name}</div><div class="card-role">${c.role}</div></div>`;
                grid.appendChild(card);
            });
            const userCard = document.createElement('div');
            userCard.className = 'char-card user-card-slot';
            userCard.innerHTML = `<div class="card-img-wrap"><img src="${userData.avatar}" class="card-img"><div class="vital-line"><div class="ecg" style="filter:hue-rotate(90deg);"></div></div><div class="status-badge" style="border-color:var(--primary); color:var(--primary);">CONNECTED</div></div><div class="card-info"><div class="card-name">${userData.name}</div><div class="card-role">${userData.rank} Class ${userData.role}</div></div>`;
            userCard.onclick = () => openUserProfile();
            grid.appendChild(userCard);
            renderBGMControls();
            startSystemLogs();

            document.querySelectorAll('.loc-item').forEach(item => {
                item.addEventListener('click', () => {
                    const title = item.dataset.title;
                    const desc = item.dataset.desc;
                    openLocationModal(title, desc);
                });
            });

            applyHoverSound(document.querySelectorAll('.char-card, .loc-item'));
        }
        function renderBGMControls() {
            const con = document.getElementById('bgm-controls');
            audioSrc.bgmList.forEach((b, i) => { const btn = document.createElement('div'); btn.className = 'bgm-btn-mini'; btn.innerText = `TRACK 0${i+1}`; btn.onclick = () => playBGM(i); con.appendChild(btn); });
            const stop = document.createElement('div'); stop.className = 'bgm-btn-mini'; stop.innerText = "STOP"; stop.style.color = "var(--alert)"; stop.onclick = () => { playSound('click'); bgm.pause(); document.querySelectorAll('.bgm-btn-mini').forEach(b=>b.classList.remove('active')); }; con.appendChild(stop);
            applyHoverSound(document.querySelectorAll('.bgm-btn-mini'));
        }
        function playBGM(idx) {
            playSound('click');
            bgm.src = audioSrc.bgmList[idx].url; bgm.volume = 0.4; bgm.play().catch(()=>{});
            document.querySelectorAll('.bgm-btn-mini').forEach(b=>b.classList.remove('active'));
            const btns = document.getElementById('bgm-controls').children;
            if(btns[idx+1]) btns[idx+1].classList.add('active');
        }
        function startSystemLogs() {
            const logBox = document.getElementById('sys-log');
            const messages = ["[SYSTEM] Scanning sector 4...", "[NET] Data packet received.", "[WARN] Anomaly detected in Shinjuku.", "[SYNC] Ren Kisaragi: Vital Stable.", "[SYNC] Tatsuya Kuroki: BPM 72.", "[SEC] Firewall updated.", "[REQ] Guiding request from Team 0.", "[LOG] Access granted to Archive.", "Downloading tactical map..."];
            setInterval(() => { const msg = messages[Math.floor(Math.random()*messages.length)]; const line = document.createElement('div'); line.className = 'log-line new'; line.innerText = `> ${msg}`; logBox.appendChild(line); logBox.scrollTop = logBox.scrollHeight; if(logBox.children.length > 10) logBox.removeChild(logBox.firstChild); }, 2000);
        }
        
        function openDetail(c) {
            playSound('click');
            document.body.classList.add('modal-open');
            document.getElementById('detail-modal').classList.remove('hidden');
            
            document.getElementById('dt-name').innerText = c.name;
            document.getElementById('dt-role').innerText = c.role;
            document.getElementById('dt-main-img').src = c.thumb;
            
            const gallery = document.getElementById('dt-gallery');
            gallery.innerHTML = '';
            c.images.forEach((src) => { 
                const d = document.createElement('div'); 
                d.className = 'slot-img'; 
                d.innerHTML = `<img src="${src}">`; 
                d.onclick = (e) => { e.stopPropagation(); openImagePopup(src); }
                gallery.appendChild(d); 
            });
            
            const voices = document.getElementById('dt-voices');
            voices.innerHTML = '';
            if (c.voices && c.voices.length > 0) {
                c.voices.forEach((v, i) => {
                    const btn = document.createElement('button');
                    btn.className = 'voice-btn';
                    btn.innerHTML = `&#9654; VOICE ${String(i+1).padStart(2,'0')}`;
                    if (v.url) {
                        btn.onclick = () => playVoice(v.line, v.url);
                    } else {
                        btn.disabled = true;
                    }
                    voices.appendChild(btn);
                });
            } else {
                voices.innerHTML = `<span style="font-size:0.8rem; color:#666;">No voice data.</span>`;
            }

            document.getElementById('dt-profile').innerText = c.profile;
            document.getElementById('dt-pers').innerText = c.pers;
            document.getElementById('dt-ability').innerText = c.ability;
            document.getElementById('dt-tmi').innerText = c.tmi;

            // â˜…â˜…â˜… ìˆ˜ì •ë¨: ìŠ¤í† ë¦¬ ìŠ¤í¬ì¼ëŸ¬ ì²˜ë¦¬ ë¡œì§ â˜…â˜…â˜…
            const storyBox = document.getElementById('dt-story');
            storyBox.classList.remove('revealed');
            const storyParts = c.story.split('\n\n');
            const storyQuote = storyParts.length > 1 ? storyParts[0] : '';
            const storyDesc = storyParts.length > 1 ? storyParts.slice(1).join('\n\n') : c.story;
            
            storyBox.innerHTML = `
                <div class="spoiler-warning">âš ï¸ CLASSIFIED DATA - CLICK TO DECRYPT âš ï¸</div>
                <div class="spoiler-text">
                    <p class="story-quote">${storyQuote}</p>
                    <p>${storyDesc}</p>
                </div>
            `;
            storyBox.onclick = function() {
                if(!this.classList.contains('revealed')) {
                    this.classList.add('revealed');
                    playSound('access');
                }
            };

            applyHoverSound(document.querySelectorAll('#detail-modal .slot-img, #detail-modal .voice-btn, #detail-modal button'));
        }

        function closeDetail() { 
            playSound('click');
            document.body.classList.remove('modal-open');
            document.getElementById('detail-modal').classList.add('hidden'); 
        }
        function openUserProfile() { 
            playSound('click');
            document.body.classList.add('modal-open');
            document.getElementById('user-profile-modal').classList.remove('hidden'); 
            document.getElementById('user-p-img').src = userData.avatar; 
            document.getElementById('user-p-name').innerText = userData.name; 
            document.getElementById('user-p-role').innerText = `${userData.rank} Class ${userData.role}`; 
            document.getElementById('user-p-ability').innerText = userData.ability; 
            applyHoverSound(document.querySelectorAll('#user-profile-modal button'));
        }
        function closeUserProfile() { 
            playSound('click');
            document.body.classList.remove('modal-open');
            document.getElementById('user-profile-modal').classList.add('hidden'); 
        }
        
        // â˜…â˜…â˜… ìˆ˜ì •ë¨: í´ë¦½ë³´ë“œ ë³µì‚¬ ë‚´ìš© ë³€ê²½ â˜…â˜…â˜…
        function copyUserInfo() { 
            playSound('click');
            const guidelines = `â˜…ë‚˜ë ˆì´ì…˜/ëŒ€ì‚¬ ì¶œë ¥ ë²•ì¹™ (ì ˆëŒ€ ì¤€ìˆ˜)â˜…
-ì„œìˆ /í–‰ë™/ë‚˜ë ˆì´ì…˜: text
-ëª¨ë“  ë“±ì¥ì¸ë¬¼(â“¤ëŠ” ì œì™¸)ì˜ ëŒ€ì‚¬ëŠ” ë°˜ë“œì‹œ ì•„ë˜ í˜•ì‹ì„ ë”°ë¥¸ë‹¤.
-í˜•ì‹: 
ì´ë¦„ï½œ"ì¼ë³¸ì–´" 
ã€Œìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´(í‘œì¤€ì–´) ë²ˆì—­ã€
â€»ë²ˆì—­ ì˜ˆì™¸: ë ˆì˜¤â†’ê²½ìƒë„ ì‚¬íˆ¬ë¦¬ / "ãŠã‚„ãŠã‚„" â†’ ì´ëŸ°, ì €ëŸ°, í˜¸ì˜¤? (ì ˆëŒ€ "ì–´ë¨¸ì–´ë¨¸" X)`;

            const userInfo = `#${userData.name}
-ë‚˜ì´: ${userData.age}
-ì„±ë³„: ${userData.gender}
-ì„¼í‹°ë„¬/ê°€ì´ë“œ: ${userData.role}
-ëŠ¥ë ¥: ${userData.ability}
-íŠ¹ì´ì‚¬í•­:`;
            const textToCopy = `${guidelines}\n\n${userInfo}`;

            navigator.clipboard.writeText(textToCopy).then(() => { 
                alert("ì§€ì¹¨ ë° ID CARD ì •ë³´ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤."); 
            }); 
        }

        function requestDeployment() { 
            playSound('click');
            closeUserProfile(); 
            alert("ê¸´ê¸‰ ì¶œë™ ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\nì‘ë‹µ ëŒ€ê¸° ì¤‘..."); 
            setTimeout(() => { 
                triggerEmergencyEvent(); 
            }, 5000); 
        }
        
        function triggerEmergencyEvent() {
            playSound('alarm', {loop: true});
            document.body.classList.add('emergency-state');
            document.body.classList.add('modal-open');
            const randomChar = characters[Math.floor(Math.random() * characters.length)];
            const modal = document.getElementById('mission-modal');
            document.getElementById('mission-char-img').src = randomChar.thumb;
            document.getElementById('mission-char-name').innerText = randomChar.name;
            document.getElementById('mission-dialogue').innerText = randomChar.missionLine;
            modal.classList.remove('hidden');
            applyHoverSound(document.querySelectorAll('#mission-modal button'));
        }
        function acceptMission() { 
            stopSound('alarm');
            playSound('access');
            alert("ë¯¸ì…˜ ìˆ˜ë½ í™•ì¸. í˜„ì¥ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤."); 
            window.location.reload(); 
        }

        function openImagePopup(src) {
            playSound('click');
            document.getElementById('popup-image-content').src = src;
            document.getElementById('image-popup').classList.remove('hidden');
            applyHoverSound(document.querySelectorAll('#image-popup button'));
        }
        function closeImagePopup() {
             playSound('click');
             document.getElementById('image-popup').classList.add('hidden');
        }
        function playVoice(line, url) {
            playSound('click');
            document.getElementById('voice-popup-text').innerText = line;
            voicePlayer.src = url;
            voicePlayer.play().catch(()=>{});
            document.getElementById('voice-popup').classList.remove('hidden');
            applyHoverSound(document.querySelectorAll('#voice-popup button'));
        }
        function closeVoicePopup() {
            voicePlayer.pause();
            voicePlayer.currentTime = 0;
            document.getElementById('voice-popup').classList.add('hidden');
        }
        voicePlayer.onended = closeVoicePopup;

        function openLocationModal(title, desc) {
            playSound('click');
            document.body.classList.add('modal-open');
            document.getElementById('loc-modal-title').innerText = title;
            document.getElementById('loc-modal-desc').innerText = desc;
            document.getElementById('location-modal').classList.remove('hidden');
            applyHoverSound(document.querySelectorAll('#location-modal button'));
        }
        function closeLocationModal() {
            playSound('click');
            document.body.classList.remove('modal-open');
            document.getElementById('location-modal').classList.add('hidden');
        }

        function applyHoverSound(elements) {
            elements.forEach(el => {
                if (el.dataset.hoverSoundApplied) return;
                el.addEventListener('mouseover', () => {
                    playSound('hover', {volume: 0.5});
                });
                el.dataset.hoverSoundApplied = 'true';
            });
        }

        applyHoverSound(document.querySelectorAll('#start-screen button, #story-screen button'));
    </script>
</body>
</html>
